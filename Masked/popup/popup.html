<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta http-equiv="Content-Security-Policy" content="default-src 'self' gap:; script-src 'self' 'unsafe-eval'; object-src *; style-src 'self' data: 'unsafe-inline'; img-src 'self' data:; media-src 'self' data:; font-src 'self' https://fonts.gstatic.com/ data:; connect-src *;">

		<script src="js/jquery-3.7.1.min.js" defer></script>
		
		<link rel="stylesheet" href="css/bootstrap-icons.min.css">
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<link rel="stylesheet" href="css/overlayscrollbars.min.css">
		<link rel="stylesheet" href="css/masked.css">

		<script src="js/bootstrap.bundle.min.js"></script>		
		<script src="js/overlayscrollbars.browser.es6.min.js" defer></script>
	</head>

	<body class="inconsolata shadow border border-black" style="width: 750px; height: 445px; overflow: hidden;">
		<div class="bg-primary bg-gradient text-white">
			<div class="d-flex justify-content-center align-content-center p-1">
				<div>
					<img src="../icons/icons8-mask2-32.png" />
				</div>
				
				<div class="ms-2">
					<h4 class="pt-1">Masked</h4>
				</div>
			</div>
		</div>

		<div class="row mb-3">
			<div class="col-4">
				<div id="list-tab" class="list-group"  style="border-top-left-radius: 0%;" role="tablist">
					<a class="list-group-item list-group-item-action border border-black active" id="list-home-list" data-bs-toggle="list" href="#list-home" role="tab" aria-controls="list-home">
						<i class="bi bi-house"></i> Home
					</a>
					<a class="list-group-item list-group-item-action" id="list-secrets-list" data-bs-toggle="list" href="#list-secrets" role="tab" aria-controls="list-secrets">
						<i class="bi bi-file-lock2"></i> Secrets
					</a>
					<a class="list-group-item list-group-item-action" id="list-regex-list" data-bs-toggle="list" href="#list-regex" role="tab" aria-controls="list-regex">
						<i class="bi bi-braces-asterisk"></i> Regex
					</a>

					<a class="list-group-item list-group-item-action" id="list-settings-list" data-bs-toggle="list" href="#list-settings" role="tab" aria-controls="list-settings" style="z-index: 100;">
						<i class="bi bi-sliders"></i> Settings
					</a>

					<a class="list-group-item list-group-item-action d-flex-inline" id="list-credits-list" data-bs-toggle="list" href="#list-credits" role="tab" aria-controls="list-credits">
						<i class="bi bi-blockquote-left"></i> Credits
					</a>
				</div>
			</div>
			
			<div id="masked-container" class="col-6 border ps-3 pt-3" style="min-height: 400px; max-height: 400px; width: 512.5px; margin-left: -12px;" >
				<div class="tab-content" id="nav-tabContent" >
					<div class="tab-pane fade show active" id="list-home" role="tabpanel" aria-labelledby="list-home-list">
						A simple plugin to convert sensitive information on the screen to a <span class="text-primary">Masked</span> format.
						The <span class="text-primary">Masked</span> value can then easily be copied to your clipboard via small icon, which
						is added into the element which was masked.	Customize your mask, add your own regular expressions and keywords and
						no longer worry about shoulder-surfers, or people watching your streams.
					</div>

					<div class="tab-pane fade overflow-auto overflow-x-hidden" id="list-secrets" role="tabpanel" aria-labelledby="list-secrets-list" style="min-height: 400px; max-height: 400px;">
						<div class="row mb-3 me-4 mt-3">
							<div class="col">
								<div class="input-group">
									<span class="input-group-text">Secrets</span>
									<select id="secrets-list" name="secrets-list" class="form-select" size="10" aria-label="Secrets" multiple ></select>
								</div>

								<div class="input-group">
									<span class="input-group-text">Add&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
									<input id="add-secret" name="add-secret" type="text" class="form-control" />
								</div>
							</div>
						</div>
						
						<div class="row mt-3">
							<div class="col text-center">
								<div class="btn-group btn-group-sm" role="group" aria-label="Secrets Group">
									<button id="secret-append" name="secret-append" class="btn btn-success" type="button">Append</button>
									<button id="secret-clear"  name="secret-clear"  class="btn btn-warning" type="button">Clear</button>
									<button id="secret-remove" name="secret-remove" class="btn btn-danger"  type="button">Remove</button>
								</div>
							</div>
						</div>
					</div>
			  
					<div id="list-regex" class="tab-pane fade overflow-auto" role="tabpanel" aria-labelledby="list-regex-list" style="min-height: 400px; max-height: 400px;">
						<div class="row mb-3 me-4 mt-3">
							<div class="col">
								<div class="input-group">
									<span class="input-group-text">Regex</span>
									<select id="regex-list" name="regex-list" class="form-select" size="10" aria-label="Regex" multiple></select>
								</div>
								<div class="input-group">
									<span class="input-group-text text-bg-secondary">Add</span>
									<span class="input-group-text text-bg-secondary">/</span>
									<input id="add-regex" name="add-regex" type="text" class="form-control" />
									<span class="input-group-text text-bg-secondary">/g</span>
								</div>
							</div>
						</div>
						
						<div class="row">
							<div class="col text-center">
								<div class="btn-group btn-group-sm" role="group" aria-label="Secrets Group">
									<button id="regex-append" name="regex-append" class="btn btn-success" type="button">Append</button>
									<button id="regex-clear"  name="regex-clear"  class="btn btn-warning" type="button">Clear</button>
									<button id="regex-remove" name="regex-remove" class="btn btn-danger"  type="button">Remove</button>
								</div>
							</div>
						</div>
					</div>
			
					<div class="tab-pane fade overflow-auto" id="list-settings" role="tabpanel" aria-labelledby="list-settings-list" style="min-height: 400px; max-height: 400px; width: 503px;" >
						<div class="row mb-3 me-4 mt-3">
							<div class="col">
								<div class="form-check form-switch">
									<input id="option-id-in-regex" name="option-id-in-regex" class="form-check-input" type="checkbox" role="switch">
									<label class="form-check-label" for="option-id-in-regex">Include Secrets in Regex Search</label>
								</div>

								<small style="font-size: 10px;">
									Any secrets which are to be searched for in ID's, will also be added to the regex list
								</small>
							</div>
						</div>

						<div class="row">
							<div class="col mt-3">
								<div class="form-check form-switch">
									<input id="option-mask-emails" name="option-mask-emails" class="form-check-input" type="checkbox" role="switch">
									<label class="form-check-label" for="option-mask-emails">Mask emails</label>
								</div>

								<small style="font-size: 10px;">
									Fields which are detected as email fields will be masked as well
								</small>
							</div>
						</div>

						<div class="row">
							<div class="col mt-3">
								<div class="form-check form-switch">
									<input id="option-enable-regex" name="option-enable-regex" class="form-check-input" type="checkbox" role="switch">
									<label class="form-check-label" for="option-enable-regex">Enable Regex Searching</label>
								</div>

								<small style="font-size: 10px;">
									Enables the regex functionality which allows you to search more fields, with more matching capabilities
								</small>
							</div>
						</div>

						<div class="row">
							<div class="col mt-3">
								<div class="form-check form-switch">
									<input id="option-enable-secret" name="option-enable-secret" class="form-check-input" type="checkbox" role="switch">
									<label class="form-check-label" for="option-enable-secret">Enable ID Searching</label>
								</div>

								<small style="font-size: 10px;">
									Enables the ID searching functionality which searches HTML elements matching input fields
								</small>
							</div>
						</div>

						<div class="row">
							<div class="col mt-3">
								<div class="form-check form-switch">
									<input class="form-check-input" type="checkbox" role="switch" id="options-enable-secret" name="options-enable-secret">
									<label class="form-check-label" for="option-mask-emails">Enable ID Searching</label>
								</div>

								<small style="font-size: 10px;">
									Enables the ID searching functionality which searches HTML elements matching input fields
								</small>
							</div>
						</div>

						<div class="row">
							<div class="col mt-3">
								<div class="form-check form-switch">
									<input class="form-check-input" type="checkbox" role="switch" id="options-enable-secret" name="options-enable-secret">
									<label class="form-check-label" for="option-mask-emails">Enable ID Searching</label>
								</div>

								<small style="font-size: 10px;">
									Enables the ID searching functionality which searches HTML elements matching input fields
								</small>
							</div>
						</div>

						<div class="row">
							<div class="col mt-3" style="max-height: 420px;">
								<div class="form-check form-switch">
									<input class="form-check-input" type="checkbox" role="switch" id="options-enable-secret" name="options-enable-secret">
									<label class="form-check-label" for="option-mask-emails">Enable ID Searching</label>
								</div>

								<small style="font-size: 10px;">
									Enables the ID searching functionality which searches HTML elements matching input fields
								</small>
							</div>
						</div>
						
						<div class="row">
							<div class="col mt-3">
								<div class="form-check form-switch">
									<input class="form-check-input" type="checkbox" role="switch" id="options-enable-secret" name="options-enable-secret">
									<label class="form-check-label" for="option-mask-emails">Enable ID Searching</label>
								</div>

								<small style="font-size: 10px;">
									Enables the ID searching functionality which searches HTML elements matching input fields
								</small>
							</div>
						</div>
					</div>

					<div class="tab-pane fade" id="list-credits" role="tabpanel" aria-labelledby="list-credits-list" style="min-height: 400px; max-height: 400px;">
						<div class="row">
							<div class="col mt-3">
								<div class="text-center">
									Most of the regular expressions and ID compositions have been collected compiled from SecLists & gitleaks<br>
									Some of the ID's are collected from websites I use<br>
									<small><a href="https://raw.githubusercontent.com/gitleaks/gitleaks/master/config/gitleaks.toml">GitLeaks .toml (Regex)</a></small><br>
									<small><a href="https://github.com/SecLists">SecLists (ID's)</a></small>
								</div>
							</div>
						</div>
					</div>

					<pre>
						<div id="status" class="text-center">
							
						</div>
					</pre>
				</div>
			</div>
		</div>

		
		<script src="../handlers.js"></script>
		<script src="../functions.js"></script>
		<script src="js/popup.js"></script>		
	</body>
</html>